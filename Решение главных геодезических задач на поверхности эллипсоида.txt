#include <iostream>
#include <math.h>
#include <stdio.h>
#define PI  3.1415926535
#define p 206265
#define eks1 0.0066943662
#define c 6399592
#define bk 6356751.5
class Ellipsoid {
    public:
    void Run_Kut_In() {
        float B1=(50.1278*PI)/180;
        float L1=(24.7538*PI)/180;
        float A1=(6.5*PI)/180;
        float S=281260.18;
        float S0=(S/c)*p;
        float betta=1.25*eks1;
        float cos2B1=cos(B1)*cos(B1);
        float gam1=betta*cos2B1;
        float V1=(1+0.6*gam1)/(1+0.2*gam1);
        float V13=V1*V1*V1;
        float DelB1=S0*V13*cos(A1);
        float DelB1rad=(DelB1/3600)*PI/180;
        float DelL1=(S0*V1*(sin(A1)/cos(B1)))/2;
        float DelL1rad=(DelL1/3600)*PI/180;
        float DelA1=(DelL1*sin(B1));
        float DelA1rad=(DelA1/3600)*PI/180;
        float B2=(B1+(0.5)*DelB1rad);
        float A2=(A1+(0.5)*DelA1rad);
        float cos2B2=cos(B2)*cos(B2);
        float gam2=betta*cos2B2;
        float V2=(1+0.6*gam2)/(1+0.2*gam2);
        float V23=V2*V2*V2;
        float DelB2=(S0*V23*cos(A2));
        float DelB2rad=(DelB2/3600)*PI/180;
        float DelL2=(S0*V2*(sin(A2)/cos(B2)))/2;
        float DelL2rad=(DelL2/3600)*PI/180;
        float DelA2=(DelL2*sin(B2));
        float DelA2rad=(DelA2/3600)*PI/180;
        float B3=(B1+(0.25)*(DelB1rad+DelB2rad));
        float A3=(A1+(0.25)*(DelA1rad+DelA2rad));
        float cos2B3=cos(B3)*cos(B3);
        float gam3=betta*cos2B3;
        float V3=(1+0.6*gam3)/(1+0.2*gam3);
        float V33=V3*V3*V3;
        float DelB3=(S0*V33*cos(A3));
        float DelB3rad=(DelB3/3600)*PI/180;
        float DelL3=(S0*V3*(sin(A3)/cos(B3)))/2;
        float DelL3rad=(DelL3/3600)*PI/180;
        float DelA3=(DelL3*sin(B3));
        float DelA3rad=(DelA3/3600)*PI/180;
        float B4=(B1-DelB2rad+2*DelB3rad);
        float A4=(A1-DelA2rad+2*DelA3rad);
        float cos2B4=cos(B4)*cos(B4);
        float gam4=betta*cos2B4;
        float V4=(1+0.6*gam4)/(1+0.2*gam4);
        float V43=V4*V4*V4;
        float DelB4=(S0*V43*cos(A4));
        float DelB4rad=(DelB4/3600)*PI/180;
        float DelL4=(S0*V4*(sin(A4)/cos(B4)))/2;
        float DelL4rad=(DelL4/3600)*PI/180;
        float DelA4=(DelL4*sin(B4));
        float DelA4rad=(DelA4/3600)*PI/180;
        float DelB=0.17*(DelB1rad+4*DelB3rad+DelB4rad);
        float DelL=0.17*(DelL1rad+4*DelL3rad+DelL4rad);
        float DelA=0.17*(DelA1rad+4*DelA3rad+DelA4rad);
        float QB2=(B1*180/PI)+(DelB*180/PI);
        float QL2=(L1*180/PI)+(DelL*180/PI);
        float QA2=(A1*180/PI)+(DelA*180/PI);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ A1-A4:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",A1,A2,A3,A4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ B1-B4:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",B1,B2,B3,B4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ V1-V4:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",V1,V2,V3,V4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ V1-V4 в кубе:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",V13,V23,V33,V43);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ DeltaB1-DeltaB4 в секундах:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",DelB1,DelB2,DelB3,DelB4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ DeltaL1-DeltaL4 в секундах:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",DelL1,DelL2,DelL3,DelL4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРОВ DeltaA1-DeltaA4 в секундах:\n\n %.6f\n %.6f\n %.6f\n %.6f\n\n",DelA1,DelA2,DelA3,DelA4);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРА ДЕЛЬТА В (в градусах) :\n\n  %.6f\n\n",DelB*180/PI);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРА ДЕЛЬТА A (в минутах):\n\n  %.6f\n\n",DelA*180/PI*60);
        printf("ЗНАЧЕНИЯ ПАРАМЕТРА ДЕЛЬТА L (в минутах) :\n\n  %.6f\n\n",DelL*180/PI*60);
        printf("ШИРОТА ТОЧКИ Q2 В ДЕСЯТИЧНЫХ ГРАДУСАХ: \n\n%.6f\n\n",QB2);
        printf("ДОЛГОТА ТОЧКИ Q2 В ДЕСЯТИЧНЫХ ГРАДУСАХ: \n\n%.6f\n\n",QL2);
        printf("ЗНАЧЕНИЕ АЗИМУТА А21 ТОЧКИ Q2 В ДЕСЯТИЧНЫХ ГРАДУСАХ: \n\n%.6f\n\n",QA2);
        
    };
    void Bessel() {
        using namespace std;
        float B1=(50.1278*PI)/180;
        float L1=(24.7538*PI)/180;
        float A1=(6.5*PI)/180;
        float S=281260.18;
        float tanU1=sqrt(1-eks1)*tan(B1);
        float tan2U1=tanU1*tanU1;
        float sinU1=(tanU1/sqrt(1+tan2U1));
        float cosU1=(1/sqrt(1+tan2U1));
        float sinA0=cosU1*sin(A1);
        float A0=(asin(sinA0));
        float A0rad=A0*PI/180;
        float cos2A0=cos(A0rad)*cos(A0rad);
        float cos4A0=cos2A0*cos2A0;
        float ctgsig1=cos(A1)/tanU1;
        float ctg2sig1=ctgsig1*ctgsig1;
        float sin2sig1=(2*ctgsig1)/(ctg2sig1+1);
        float cos2sig1=(ctg2sig1-1)/(ctg2sig1+1);
        float k2=eks1*cos2A0;
        float k4=k2*k2;
        float k6=k2*k2*k2;
        float eks12=eks1*eks1;
        float eks13=eks1*eks1*eks1;
        float A=bk*(1+(k2/4)-((3*k4)/64)+((5*k6)/256));
        float B=bk*(k2/8-(k4/32)+((15*k6)/1024));
        float C=bk*(k4/128-((3*k6)/512));
        float alfa=(((eks1/2)+(eks12/8)+(eks13/16))-((eks12+eks13)/16)*cos2A0+3*eks13*cos4A0/128)*p;
        float alfarad=(alfa/3600)*PI/180;
        float betta=(((eks12/32)+eks13/32)*cos2A0-eks13*cos4A0/64)*p;
        float bettarad=(betta/3600)*PI/180;
        float sig0=(((S-(B+C*cos2sig1)*sin2sig1))/A);
        float sig0rad=sig0*PI/180;
        float sin2sig1sig0=sin2sig1*cos(2*sig0rad)+cos2sig1*sin(2*sig0rad);
        float cos2sig1sig0=cos2sig1*cos(2*sig0rad)-sin2sig1*sin(2*sig0rad);
        float sig=sig0+(B+5*C*cos2sig1sig0)*(sin2sig1sig0/A);
        float sigrad=sig*PI/180;
        float Delta=((alfarad*sigrad)+bettarad*(sin2sig1sig0-sin2sig1))*sinA0;
        float sinU2=sinU1*cos(sig)+cosU1*cos(A1)*sin(sig);
        float U2=asin(sinU2);
        float tanU2=tan(U2);
        float tanlyamb=(sin(A1)*sin(sigrad))/(cosU1*cos(sigrad)-sinU1*sin(sigrad)*cos(A1));
        float lyamb=atan(tanlyamb);
        float tanA2=(cosU1*sin(A1))/(cosU1*cos(sigrad)*cos(A1)-sinU1*sin(sigrad));
        float A2=atan(tanA2);
        float tanB2=(1/sqrt(1-eks1))*tan(U2);
        float B2=atan(tanB2)*180/PI;
        float L2=(L1+lyamb-Delta)*180/PI;
        float A21=A2*180/PI+180;
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА ШИРОТЫ В1:\n\n%.6f\n\n",B1*180/PI);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА УГЛА A1:\n\n%.6f\n\n",A1*180/PI);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА ДОЛГОТЫ L1:\n\n%.6f\n\n",L1*180/PI);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА РАССТОЯНИЯ S:\n\n%.6f\n\n",S);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА КОРЕНЬ(1-EKS1):\n\n%.6f\n\n",sqrt(1-eks1));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА ТАНГЕНС U1\n\n %.6f\n\n",tanU1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sin U1\n\n %.6f\n\n",sinU1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cos U1\n\n %.6f\n\n",cosU1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sin A1\n\n %.6f\n\n",sin(A1));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cos A1\n\n %.6f\n\n",cos(A1));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sin А0\n\n %.6f\n\n",sinA0);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cos^2А0\n\n %.6f\n\n",cos2A0);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА ctgsig1\n\n %.6f\n\n",ctgsig1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sin(2sig1)\n\n %.6f\n\n",sin2sig1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cos(2sig1)\n\n %.6f\n\n",cos2sig1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА A\n\n %.6f\n\n",A);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА B\n\n %.6f\n\n",B);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА C\n\n %.6f\n\n",C);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА alfa\n\n %.6f\n\n",alfa);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА betta\n\n %.6f\n\n",betta);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sig0\n\n %.6f\n\n",sig0);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sin2(sig1+sig0)\n\n %.6f\n\n",sin2sig1sig0);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cos2(sig1+sig0)\n\n %.6f\n\n",cos2sig1sig0);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sig\n\n %.6f\n\n",sig);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Delta\n\n %.6f\n\n",Delta);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sinU2\n\n %.6f\n\n",sinU2);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА U2\n\n %.6f\n\n",U2);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА B2\n\n %.6f\n\n",B2);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА tanlyamb\n\n %.6f\n\n",tanlyamb);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА lyamb в секундых\n\n %.6f\n\n",lyamb*180/PI*120000);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА L2\n\n %.6f\n\n",L2);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА tanA2\n\n %.6f\n\n",tanA2);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА A2\n\n %.6f\n\n",A2*180/PI);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА A21\n\n %.6f\n\n",A21);
        cout<<"\n\n-------------------------\n\n";
    };
    void Srednie() {
        using namespace std;
        float B1=(50.1278*PI)/180;
        float L1=(24.7538*PI)/180;
        float A1=(6.5*PI)/180;
        float B2=(52.639614*PI)/180;
        float L2=(24.990330*PI)/180;
        float A2=(6.5*PI)/180;
        float S=281260.18;
        float DeltaB=B2-B1;
        float DeltaB2=DeltaB*DeltaB;
        float l=L2-L1;
        float l2=l*l;
        float Bm=(B2+B1)/2;
        float sin2Bm=sin(Bm)*sin(Bm);
        float cos2Bm=cos(Bm)*cos(Bm);
        float Vm=sqrt(1+eks1*cos2Bm);
        float Vm3=Vm*Vm*Vm;
        float Nm=c/Vm;
        float Mm=c/Vm3;
        float kont=Nm/Mm;
        float Vm2=Vm*Vm;
        float Q=DeltaB*Mm*(1-(l2*(2*sin2Bm))/24);
        float P=l*Nm*cos(Bm)*(1+(DeltaB2-(l*sin(Bm)*(l*sin(Bm))))/24);
        float DeltaA=l*sin(Bm)*(1+((3*DeltaB2)+2*l2-2*(l*sin(Bm)*(l*sin(Bm))))/24)*206265;
        float tanAm=P/Q;
        float Am=atan(tanAm);
        float A12=(Am+(DeltaA/7200)*180/PI);
        float A21=((Am+DeltaA/7200)*180/PI)+180;
        float Sq=sqrt(Q*Q+P*P);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА B2rad = %.6f\n\n",B2);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА B1rad = %.6f\n\n",B1);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА DeltaBrad = %.6f\n\n",DeltaB);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА lrad = %.6f\n\n",l);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Bmrad = %.6f\n\n",Bm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА sinBm = %.6f\n\n",sin(Bm));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА cosBm = %.6f\n\n",cos(Bm));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА eks1cos2bm = %.6f\n\n",eks1*cos2Bm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Vm = %.6f\n\n",Vm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Nm = %.6f\n\n",Nm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Mm = %.6f\n\n",Mm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Q = %.6f\n\n",Q);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА P = %.6f\n\n",P);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА tgAm = %.6f\n\n",tanAm);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Am = %.6f\n\n",atan(tanAm)*180/PI);
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА lsinBm = %.6f\n\n",l*sin(Bm));
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА DeltaA = %.6f\n\n",DeltaA);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА A12 = %.6f\n\n",A12);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА A21 = %.6f\n\n",A21);
        cout<<"\n\n-------------------------\n\n";
        printf("ЗНАЧЕНИЕ ПАРАМЕТРА Sq = %.6f\n\n",Sq);

    };
};
int main(){
    using namespace std;
    cout<<"\n\n-------------------------\n\n";
    cout<<"ЛАБОРАТОРНАЯ РАБОТА НОМЕР 5. РЕШЕНИЕ ГЛАВНЫХ ГЕОДЕЗИЧЕСКИХ ЗАДАЧ НА ПОВЕРХНОСТИ ЭЛЛИПСОИДА\n\n";
    cout<<"\n\n-------------------------\n\n";
    cout<<"ПЕРВАЯ ЧАСТЬ ЗАДАНИЯ СОСТОИТ В РЕШЕНИИ ПРЯМОЙ ГЕОДЕЗИЧЕСКОЙ ЗАДАЧИ НА ПОВЕРХНОСТИ ЭЛЛИПСОИДА ПЗ90 СПОСОБОМ РУНГЕ-КУТТА-ИНГЛАНДА\n\n";
    Ellipsoid PZ90;
    PZ90.Run_Kut_In();
    cout<<"\n\n-------------------------\n\n";
    cout<<"ВТОРАЯ ЧАСТЬ ЗАДАНИЯ СОСТОИТ В РЕШЕНИИ АНАЛОГИЧНОЙ ЗАДАЧИ СПОСОБОМ БЕССЕЛЯ (1-ЫМ АЛГОРИТМОМ)\n\n";
    PZ90.Bessel();
    cout<<"ПРОСМОТРЕВ ЗНАЧЕНИЯ, ПОЛУЧЕННЫЕ ДВУМЯ СПОСОБАМИ, (СПОСОБОМ БЕССЕЛЯ И СПОСОБОМ РУНГЕ-КУТТА-ИНГЛАНДА, УВИДИМ, ЧТО ОНИ ИДЕНТИЧНЫ. ЭТО ЗНАЧИТ ЧТО ПРЯМАЯ ГЕОДЕЗИЧЕСКАЯ ЗАДАЧА РЕШЕНА ВЕРНА. КОНТРОЛЬ СОБЛЮДЕН.";
    cout<<"\n\n-------------------------\n\n";
    cout<<"ЗАКЛЮЧИТЕЛЬНАЯ ЧАСТЬ ЗАДАНИЯ СОСТОИТ В РЕШЕНИИ ОБРАТНОЙ ГЕОДЕЗИЧЕСКОЙ ЗАДАЧИ ПО ФОРМУЛАМ СО СРЕДНИМИ АРГУМЕНТАМИ\n\n";
    PZ90.Srednie();
    return 0;
}